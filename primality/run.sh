#!/bin/bash
##############################################################
############## M A I N ########################################
##############################################################

# Run this script by ./run.sh > log.txt

clear
echo "cleaning output"
rm output

echo "Compiling "
gcc -o output primality_nist.c millerRabinNist.c generalNist.c -std=gnu99 -D DEBUG=0 -D DIGITAL_SIGNATURE=0 -D FEATURE_SEED=1 -lcrypto -lm -lgmp -lc

if [ "$1" != "" ]; then
# If something is sent as an argument, copy the output and run the main php program
	cp output ../
	cd  ..
	php rsa.php
else
	echo "Running ouput"
#./output <Length of P prime> <Length of Q prime> <Length of the seed for PRG> <Number of Iterations for Rabin-Miller>
	./output 2048 1024 1024 100
# also copy the output to the php folder
	cp output ../
fi

# Below is the scipt to test the primes number generation execution time
: '
echo "###############################################################################"
echo "L=1024bits, N=160bits, SeedLen=1024, Iterations= 500"
echo "###############################################################################"
./output 1024 160 1024 500

echo "###############################################################################"
echo "L=2048bits, N=224bits, SeedLen=1024, Iterations= 500"
echo "###############################################################################"
./output 2048 224 1024 500

echo "###############################################################################"
echo "L=2048bits, N=256bits, SeedLen=1024, Iterations= 500"
echo "###############################################################################"
./output 2048 256 1024 500

echo "###############################################################################"
echo "L=3072bits, N=256bits, SeedLen=1024, Iterations= 500"
echo "###############################################################################"
./output 3072 256 1024 500

echo "###############################################################################"
echo "L=1024bits, N=160bits, SeedLen=2048, Iterations= 500"
echo "###############################################################################"
./output 1024 160 2048 500

echo "################################################################################"
echo "L=2048bits, N=224bits, SeedLen=2048, Iterations= 500"
echo "################################################################################"
./output 2048 224 2048 500

echo "################################################################################"
echo "L=2048bits, N=256bits, SeedLen=2048, Iterations= 500"
echo "################################################################################"
./output 2048 256 2048 500

echo "################################################################################"
echo "L=3072bits, N=256bits, SeedLen=2048, Iterations= 500"
echo "################################################################################"
./output 3072 256 2048 500

echo "################################################################################"
echo "L=1024bits, N=160bits, SeedLen=2048, Iterations= 100"
echo "################################################################################"
./output 1024 160 2048 100

echo "################################################################################"
echo "L=2048bits, N=224bits, SeedLen=2048, Iterations= 100"
echo "################################################################################"
./output 2048 224 2048 100

echo "################################################################################"
echo "L=2048bits, N=256bits, SeedLen=2048, Iterations= 100"
echo "#################################################################################"
./output 2048 256 2048 100

echo "##################################################################################"
echo "L=3072bits, N=256bits, SeedLen=2048, Iterations= 100"
echo "##################################################################################"
'

